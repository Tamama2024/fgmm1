<!DOCTYPE html>
<html lang="en">

<head>
  <title>問卷測試</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!--===============================================================================================-->
  <link rel="icon" type="image/png" href="images/icons/favicon.ico" />
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="fonts/Linearicons-Free-v1.0.0/icon-font.min.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="vendor/daterangepicker/daterangepicker.css">
  <!--===============================================================================================-->
  <link rel="stylesheet" type="text/css" href="css/util.css">
  <link rel="stylesheet" type="text/css" href="css/main.css">
  <!--===============================================================================================-->  
</head>

<body>
  <div class="container-contact100">       
    <div class="wrap-contact100">
      <form id="google-form" class="contact100-form validate-form">
        <span class="contact100-form-title">
          問卷測試_Test_109
        </span>

        
      <section class="form w-640">
        <div class="form-group">
          <label for="main_id">請輸入 ID（0101 - 0112）</label>
          <input class="form-control" id="main_id" type="number" v-model="id" @input="limitIdLen(id)"/>
        </div>
        <div class="two-col">
          <div class="col">
            <div class="form-group">
              <label for="name">姓名</label>
              <div class="prepend">
                <div class="pre male" v-if="person.gender == '男'">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
                    <path fill="none" d="M0 0h24v24H0z"></path>
                    <path fill="#00A7E5" d="M18.586 5H14V3h8v8h-2V6.414l-3.537 3.537a7.5 7.5 0 1 1-1.414-1.414L18.586 5z"></path>
                  </svg>
                </div>
                <div class="pre female" v-if="person.gender == '女'">
                  <female></female>
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
                    <path fill="none" d="M0 0h24v24H0z"></path>
                    <path fill="#E91E63" d="M11 15.934A7.501 7.501 0 0 1 12 1a7.5 7.5 0 0 1 1 14.934V18h5v2h-5v4h-2v-4H6v-2h5v-2.066z"></path>
                  </svg>
                </div>
                <input class="form-control" id="name" type="text" v-model="person.name" disabled="disabled"/>
              </div>
            </div>
          </div>
          <div class="col">
            <div class="form-group">
              <label for="phone">電話</label>
              <input class="form-control" id="phone" type="tel" v-model="person.phone" disabled="disabled"/>
            </div>
          </div>
        </div>
        <div class="form-group">
          <label for="site">地址</label>
          <input class="form-control" id="site" type="text" v-model="person.site" disabled="disabled"/>
        </div>
        <div class="form-group">
          <label for="message">備註</label>
          <input class="form-control" id="message" type="text" v-model="person.message" :disabled="person.name == undefined"/>
        </div>
        <div class="submit"><a href="#" :class="{ disabled: person.name == undefined }" @click.prevent="submit">送出</a></div>
      </section>
        
        
        <label class="label-input100" for="uid">Uid *</label>
        <div class="wrap-input100 validate-input" data-validate="Uid為必填">
          <input id="uid" class="input100" type="text" placeholder="請勿修改">
          <span class="focus-input100"></span>
        </div>
        
        <label class="label-input100" for="first-name">姓名 *</label>
        <div class="wrap-input100 validate-input" data-validate="姓名為必填">
          <input id="name" class="input100" type="text" placeholder="王大明">
          <span class="focus-input100"></span>
        </div>

        <label class="label-input100" for="email">email</label>
        <div class="wrap-input100">
          <input id="email" class="input100" type="text" placeholder="Eg. example@email.com">
          <span class="focus-input100"></span>
        </div>

        <label class="label-input100" for="message">您的建議</label>
        <div class="wrap-input100" data-validate="Message is required">
          <textarea id="message" class="input100" placeholder="Write us a message" disabled="disabled"></textarea>
          <span class="focus-input100"></span>
        </div>
        
        <label class="label-input100" for="score">議題 (一) (下拉式三個選項) *</label>
        <div class="wrap-input100 validate-input" data-validate="請核選">
          <select class="form-control" id="score" style="border: 0px;">
            <option value="0" selected disabled>請選擇</option>
            <option value="同意">同意</option>
            <option value="不同意">不同意</option>
            <option value="棄票">棄票</option>
          </select>
        </div>
        
        <label class="label-input100" for="score1">議題 (二) (下拉式三個選項) *</label>
        <div class="wrap-input100 validate-input" data-validate="請核選">
          <select class="form-control" id="score1" style="border: 0px;">
            <option value="0" selected disabled>請選擇</option>
            <option value="同意">同意</option>
            <option value="不同意">不同意</option>
            <option value="棄票">棄票</option>
          </select>
        </div>

        <label class="label-input100" for="score2">議題 (三) (下拉式三個選項) *</label>
        <div class="wrap-input100 validate-input" data-validate="請核選">
          <select class="form-control" id="score2" style="border: 0px;">
            <option value="0" selected disabled>請選擇</option>
            <option value="同意">同意</option>
            <option value="不同意">不同意</option>
            <option value="棄票">棄票</option>
          </select>
        </div>

        <label class="label-input100" for="score3">議題 (四) (下拉式三個選項) *</label>
        <div class="wrap-input100 validate-input" data-validate="請核選">
          <select class="form-control" id="score3" style="border: 0px;">
            <option value="0" selected disabled>請選擇</option>
            <option value="同意">同意</option>
            <option value="不同意">不同意</option>
            <option value="棄票">棄票</option>
          </select>
        </div>

        <label class="label-input100" for="score4">議題 (五) (下拉式三個選項) *</label>
        <div class="wrap-input100 validate-input" data-validate="請核選">
          <select class="form-control" id="score4" style="border: 0px;">
            <option value="0" selected disabled>請選擇</option>
            <option value="同意">同意</option>
            <option value="不同意">不同意</option>
            <option value="棄票">棄票</option>
          </select>
        </div>
        
        <!--Submisson Button 送出-->
        <div class="container-contact100-form-btn">
          <button class="contact100-form-btn">
            送出
          </button>
        </div>
      </form>

      <div class="contact100-more flex-col-c-m" style="background-image: url('images/bg-01.jpg'); width: 50%">
        <div class="flex-w size1 p-b-47">
          <div class="txt1 p-r-25">
            <span class="lnr lnr-map-marker"></span>
          </div>

          <div class="flex-col size2">
            <span class="txt1 p-b-20">
              地址
            </span>

            <span class="txt2">
              台北市最好吃的中華一番料理
            </span>
          </div>
        </div>

        <div class="dis-flex size1 p-b-47">
          <div class="txt1 p-r-25">
            <span class="lnr lnr-phone-handset"></span>
          </div>

          <div class="flex-col size2">
            <span class="txt1 p-b-20">
              電話
            </span>

            <span class="txt3">
              <a href="tel:+886-2-0223456789">02 2345 6789</a>
            </span>
          </div>
        </div>

        <div class="dis-flex size1 p-b-47">
          <div class="txt1 p-r-25">
            <span class="lnr lnr-envelope"></span>
          </div>

          <div class="flex-col size2">
            <span class="txt1 p-b-20">
              聯絡我們
            </span>

            <span class="txt3">
              baobaonevertell@email.com
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="dropDownSelect1"></div>

  <!--===============================================================================================-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.11/vue.min.js"></script>
  <script src="dist/main.min.js"></script>
  <!--===============================================================================================-->
  <script src="vendor/jquery/jquery-3.2.1.min.js"></script> 
  <!--===============================================================================================-->
  <script src="vendor/animsition/js/animsition.min.js"></script>
  <!--===============================================================================================-->
  <script src="vendor/bootstrap/js/popper.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
  <!--===============================================================================================-->
  <script src="vendor/select2/select2.min.js"></script>
  <script>
    $(".selection-2").select2({
      minimumResultsForSearch: 20,
      dropdownParent: $('#dropDownSelect1')
    });
  </script>
  <!--===============================================================================================-->
  <script src="vendor/daterangepicker/moment.min.js"></script>
  <script src="vendor/daterangepicker/daterangepicker.js"></script>
  <!--===============================================================================================-->
  <script src="vendor/countdowntime/countdowntime.js"></script>
  <!--===============================================================================================-->
  <script src="js/main.js"></script>
  <script>

    $('#google-form').submit(function (e) {
      
      //在這裡我們要先擋掉form默認事件
      e.preventDefault();
      if ($('#uid').val() && $('#name').val() && $('#score').val()) {//需要先確認必填欄位是否填寫
        $.ajax({
          // url為Google Form按下submit的aciotn
          url: "https://docs.google.com/forms/u/0/d/e/1FAIpQLSflQC8LCB1ce_reXie5WGqfGYhJzQevXtL9Y0_SA617LYo39A/formResponse",
          crossDomain: true,//解決跨網域CORS的問題
          data: {// entry.xxxxx 這些需要填寫您表單裡面的值，與其相互對應
            "entry.642821324": $('#uid').val(),
            "entry.1487138390": $('#name').val(),
            "entry.498756846": $('#email').val(),
            "entry.318662779": $('#message').val(),
            "entry.982130188": $('#score').val(),
            "entry.1436740018": $('#score1').val(),
            "entry.1724544777": $('#score2').val(),
            "entry.799531533": $('#score3').val(),         
            "entry.1270733593": $('#score4').val()
          },
          type: "POST", //因為是要進行insert的動作，故事用POST
          dataType: "JSONP",
          complete: function () {
            //完成後把這些欄位清空
            $('#uid').val('')
            $('#name').val('')
            $('#email').val('')
            $('#message').val('')    
            $('#score').val('')
            $('#score1').val('')
            $('#score2').val('') 
            $('#score3').val('') 
            $('#score4').val('')           
            //最後跳轉到感謝的頁面
            window.location.replace("thank.html");
          }
        });
      }
    });
  </script>
</body>

</html>
